{"timestamp": 1697477964.679124, "stored_source_code": "# declare a list tasks whose products you want to use as inputs\nupstream = None\n\nfrom pathlib import Path\nimport pandas as pd\n# Load database\n# Loading in SQL extension\n%reload_ext sql\n\n# Initiating a DuckDB database named 'car_data.duckdb' to run SQL queries\n%sql duckdb:///../data/database/car_data.duckdb\n%sqlcmd tables\n%sqlcmd explore --table all_vehicles\n%sqlcmd explore --table electric\n## Store queries\n### Tables for Plot 1\n%%sql\nCREATE TABLE q_1_hybrid_electric AS\n    SELECT DISTINCT model_year, vehicle_type, COUNT(id) AS num_vehicles\n    FROM all_vehicles\n    WHERE vehicle_type = 'hybrid' OR vehicle_type = 'electric'\n    GROUP BY model_year, vehicle_type\n    ORDER BY num_vehicles DESC;\n%%sql\nCREATE TABLE q_1_fuel AS\n    SELECT DISTINCT model_year, vehicle_type, COUNT(id) AS num_vehicles\n    FROM fuel\n    GROUP BY model_year, vehicle_type\n    ORDER BY model_year;\n#### Verify data\n%%sql \nSELECT * FROM q_1_hybrid_electric;\n%%sql \nSELECT * FROM q_1_fuel;\n## Table for Plot 2\n%%sql \nCREATE TABLE boxplot_fuel_consum AS\n    SELECT consumption_city_l_100_km, consumption_hwy_l_100_km, consumption_comb_l_100_km, co2_emissions_g_km\n    FROM all_vehicles;\n#### Verify data\n%%sql\nSELECT * FROM boxplot_fuel_consum; \n## Table for Plot 3\n%%sql\nCREATE TABLE electric_range_charge AS\n    SELECT range_km, recharge_time_h, vehicle_class, model_year\n    FROM electric\n#### Verify data\n%%sql\nSELECT * FROM  electric_range_charge\n## Table for Plot 4\n%%sql\nCREATE TABLE hist_co2 AS\n    SELECT vehicle_type, fuel_type, co2_emissions_g_km\n    FROM all_vehicles\n    WHERE co2_emissions_g_km IS NOT NULL;\n#### Verify data\n%%sql\nSELECT * FROM hist_co2\n## Tables for Plot 5\n%%sql\nCREATE TABLE co2_usa AS\n    SELECT vehicle_type, make, co2_emissions_g_km, transmission_type\n    FROM all_vehicles\n    WHERE co2_emissions_g_km IS NOT NULL AND\n    vehicle_type IN ('fuel-only', 'hybrid') AND\n    make IN ('cadillac', 'chevrolet', 'chrysler', 'ford', 'jeep', 'lincoln')\n#### Verify data\n%%sql\nSELECT * FROM co2_usa;\n", "params": {}}